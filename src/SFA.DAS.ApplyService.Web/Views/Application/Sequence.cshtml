@using SFA.DAS.ApplyService.Domain.Entities
@model SFA.DAS.ApplyService.Domain.Entities.ApplicationSequence

@{
    ViewBag.Title = "Application overview";
    Layout = "_Layout";
}

<a asp-action="Applications" asp-controller="Application" class="govuk-back-link">Back to application selection</a>
<main class="govuk-main-wrapper " id="main-content" role="main">
    <div class="govuk-grid-row">
        <div class="govuk-grid-column-two-thirds">

            @if (Model.Status == ApplicationSequenceStatus.Submitted)
            {
                <h1 class="govuk-heading-xl">Application submitted</h1>
                <h2 class="govuk-heading-m">What happens next?</h2>
                <ul class="govuk-list govuk-list--bullet">
                    <li>we'll review your application</li>
                    <li>we'll email you the outcome</li>
                </ul>
                <h2 class="govuk-heading-m">How long before I hear about my application?</h2>
                <p class="govuk-body">You'll hear from us within 4 weeks.</p>
                <p class="govuk-body"><a asp-action="Applications" asp-controller="Application" class="govuk-link">Back to application selection</a></p>
            }
            else
            {
                <h1 class="govuk-heading-xl">Application overview</h1>
                <ul class="govuk-list">
                    @foreach (var applicationSection in Model.Sections)
                    {
                        <li>
                            <h2 class="gvuk-heading-m govuk-!-margin-bottom-2">
                                @applicationSection.LinkTitle
                            </h2>
                            <span id="company-details-hint" class="govuk-hint">
                                @applicationSection.PagesComplete of @applicationSection.PagesActive questions completed
                            </span>
                            @if (Model.Status != ApplicationSequenceStatus.Submitted)
                            {
                                <a class="govuk-link" href="@Url.Action("Section", "Application", new {applicationSection.ApplicationId, applicationSection.SectionId})">
                                    Go to @applicationSection.LinkTitle.ToLower()
                                </a>
                            }
                        </li>
                        <hr class="govuk-section-break govuk-section-break--l govuk-section-break--visible">
                    }
                </ul>
                @if (Model.Sections.Sum(m => m.PagesComplete) == Model.Sections.Sum(m => m.PagesActive) && Model.Status != ApplicationSequenceStatus.Submitted)
                {
                    <div>
                        <form asp-action="Submit" asp-controller="Application">
                            <input type="hidden" id="applicationId" name="applicationId" value="@Model.ApplicationId"/>
                            <input type="hidden" id="sequenceId" name="sequenceId" value="@Model.SequenceId"/>
                            <button class="govuk-button">Continue</button>
                        </form>
                    </div>
                }
            }
        </div>
    </div>
</main>