@using Newtonsoft.Json
@using SFA.DAS.ApplyService.Domain.Apply;
@model SFA.DAS.ApplyService.Web.Controllers.QuestionViewModel

@{
    var isError = Model.ErrorMessages != null && Model.ErrorMessages.Count > 0 ? "govuk-input--error" : "";

    var tableData = JsonConvert.DeserializeObject<TabularData>(Model.Value);
}

@if (Model.ErrorMessages!=null && Model.ErrorMessages.Count > 0)
{
    foreach (var errorMessage in Model.ErrorMessages)
    {
        if (errorMessage.Field == Model.QuestionId)
        {
            <span class="govuk-error-message">@errorMessage.ErrorMessage</span>
        }
    }
}

<table class="govuk-table">
    @if (!String.IsNullOrWhiteSpace(tableData.Caption))
    {
        <caption class="govuk-table__caption">
            @tableData.Caption
        </caption>
    }
    <thead class="govuk-table__head">
    <tr class="govuk-table__row">
        @foreach (var title in tableData.HeadingTitles)
        {
            <th class="govuk-table__header" scope="col">@Html.Raw(title)</th>
        }
    </tr>
    </thead>
    <tbody class="govuk-table_body">
    @foreach (var dataRow in tableData.DataRows)
    {
        <tr class="govuk-table__row">
            @foreach (var column in dataRow.Columns)
            {
                <td class="govuk-table__cell">@Html.Raw(column)</td>
            }
        </tr>
    }
    </tbody>
</table>